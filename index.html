<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Day Planner</title>
<style>
  :root {
    --bg: #fff;
    --surface: #f7f7f7;
    --border: #e0e0e0;
    --border-light: #f0f0f0;
    --text: #000;
    --text-mid: #444;
    --text-dim: #888;
    --text-faint: #bbb;
    --accent: #c46b2e;
    --white: #fff;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: -apple-system, BlinkMacSystemFont, 'Helvetica Neue', sans-serif; background: var(--bg); color: var(--text); display: flex; height: 100vh; overflow: hidden; font-size: 14px; -webkit-font-smoothing: antialiased; }

  .sidebar { width: 220px; min-width: 220px; background: var(--white); border-right: 1px solid var(--border); display: flex; flex-direction: column; overflow: hidden; }
  .sidebar-header { padding: 24px 20px 16px; }
  .sidebar-header h1 { font-size: 15px; font-weight: 600; letter-spacing: -0.3px; }
  .today-btn { margin: 0 16px 12px; padding: 7px 0; background: var(--text); color: var(--white); border: none; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 500; }
  .today-btn:hover { background: #333; }
  .nav-scroll { flex: 1; overflow-y: auto; padding-bottom: 20px; }
  .year-label { padding: 10px 20px 4px; font-size: 11px; font-weight: 700; color: var(--text-dim); letter-spacing: 1px; text-transform: uppercase; }
  .month-label { padding: 6px 20px; font-size: 12px; font-weight: 600; color: var(--text-mid); cursor: pointer; display: flex; align-items: center; gap: 6px; }
  .month-label:hover { color: var(--text); }
  .month-label .arr { font-size: 8px; color: var(--text-faint); transition: transform 0.15s; }
  .collapsed .arr { transform: rotate(-90deg); }
  .collapsed .day-list { display: none; }
  .day-item { padding: 4px 20px 4px 32px; font-size: 12px; color: var(--text-dim); cursor: pointer; line-height: 1.8; }
  .day-item:hover { color: var(--text); background: var(--surface); }
  .day-item.active { color: var(--white); background: var(--text); border-radius: 4px; margin: 1px 12px; padding-left: 20px; font-weight: 500; }
  .day-item.today:not(.active) { color: var(--accent); font-weight: 600; }
  .day-item.has-plans::after { content: '¬∑'; margin-left: 6px; color: var(--accent); font-weight: 900; font-size: 16px; line-height: 0; vertical-align: middle; }

  .main { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
  .main-header { padding: 20px 32px 12px; display: flex; align-items: baseline; justify-content: space-between; }
  .main-header h2 { font-size: 20px; font-weight: 700; letter-spacing: -0.5px; }
  .header-right { display: flex; gap: 6px; align-items: center; }
  .nav-btn { background: none; border: 1px solid var(--border); color: var(--text-mid); width: 28px; height: 28px; border-radius: 5px; cursor: pointer; font-size: 13px; display: flex; align-items: center; justify-content: center; }
  .nav-btn:hover { background: var(--surface); }
  .export-btn { background: none; border: 1px solid var(--border); color: var(--text-dim); padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 11px; font-weight: 500; }
  .export-btn:hover { background: var(--surface); color: var(--text); }

  .day-summary { padding: 0 32px 14px; display: flex; gap: 16px; font-size: 11px; color: var(--text-dim); font-weight: 500; }
  .stat { display: flex; align-items: center; gap: 5px; }
  .stat-bar { width: 6px; height: 6px; border-radius: 1px; }
  .stat-bar.planned { background: var(--text-dim); }
  .stat-bar.done { background: var(--text); }
  .stat-bar.missed { background: var(--accent); }

  .schedule { flex: 1; overflow-y: auto; padding: 0 32px 40px; }
  .col-headers { display: grid; grid-template-columns: 56px 1fr 1fr; border-bottom: 2px solid var(--text); padding: 6px 0; margin-bottom: 2px; position: sticky; top: 0; background: var(--bg); z-index: 5; }
  .col-headers span { font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; color: var(--text-mid); }
  .col-headers span:first-child { color: var(--text-dim); }
  .col-headers span:nth-child(2) { padding-left: 12px; }
  .col-headers span:nth-child(3) { padding-left: 12px; color: var(--text-dim); }

  .slot-row { display: grid; grid-template-columns: 56px 1fr 1fr; min-height: 36px; transition: background 0.1s; }
  .slot-row:hover { background: var(--surface); }
  .slot-row.current { background: rgba(196, 107, 46, 0.04); }
  .slot-row.hour-start { border-top: 1px solid var(--border); }
  .slot-row.half-hour { border-top: 1px solid var(--border-light); }

  .slot-time { padding: 8px 8px 8px 0; font-size: 11px; font-weight: 500; color: var(--text-faint); text-align: right; font-variant-numeric: tabular-nums; }
  .slot-row.half-hour .slot-time { font-size: 10px; color: var(--border); }
  .slot-row.current .slot-time { color: var(--accent); font-weight: 700; }

  .slot-cell { padding: 6px 10px; border-left: 1px solid var(--border-light); }
  .cell-input { width: 100%; min-height: 20px; padding: 2px 4px; font-size: 12px; line-height: 1.5; color: var(--text); border: none; background: transparent; resize: none; font-family: inherit; outline: none; border-radius: 3px; }
  .cell-input:focus { background: var(--surface); box-shadow: 0 0 0 1px var(--border); }
  .cell-input::placeholder { color: var(--text-faint); font-style: normal; }
  .actual-cell .cell-input { color: var(--text-mid); }
  .actual-cell .cell-input::placeholder { color: var(--border); }

  .toast { position: fixed; bottom: 20px; right: 20px; background: var(--text); color: var(--white); padding: 8px 16px; border-radius: 6px; font-size: 12px; font-weight: 500; opacity: 0; transition: opacity 0.3s; pointer-events: none; }
  .toast.show { opacity: 1; }

  ::-webkit-scrollbar { width: 4px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }

  @media (max-width: 768px) {
    .sidebar { display: none; }
    .schedule { padding: 0 16px 40px; }
    .main-header { padding: 16px 16px 10px; }
    .day-summary { padding: 0 16px 10px; }
  }
</style>
</head>
<body>

<div class="sidebar">
  <div class="sidebar-header"><h1>Day Planner</h1></div>
  <button class="today-btn" onclick="goToday()">Today</button>
  <div class="nav-scroll" id="sidebar-nav"></div>
</div>

<div class="main">
  <div class="main-header">
    <h2 id="title"></h2>
    <div class="header-right">
      <button class="nav-btn" onclick="prevDay()">‚Äπ</button>
      <button class="nav-btn" onclick="nextDay()">‚Ä∫</button>
      <button class="export-btn" onclick="exportMD()">Export</button>
    </div>
  </div>
  <div class="day-summary" id="summary"></div>
  <div class="schedule">
    <div class="col-headers"><span></span><span>Plan</span><span>Actual</span></div>
    <div id="grid"></div>
  </div>
</div>

<div class="toast" id="toast">Saved</div>
<script>
const STORE = 'dp_v9';
let cur = new Date();
let data = {};

function load() { try { data = JSON.parse(localStorage.getItem(STORE) || '{}'); } catch(e) { data = {}; } }
function save() {
  localStorage.setItem(STORE, JSON.stringify(data));
  const t = document.getElementById('toast'); t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 1200);
}

function dk(d) { return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`; }
function gd(k) { if (!data[k]) data[k] = {}; return data[k]; }
function slotKey(h, m) { return `${String(h).padStart(2,'0')}:${m === 0 ? '00' : '30'}`; }

function set(k, sk, f, v) { const d = gd(k); if (!d[sk]) d[sk] = { p: '', a: '' }; d[sk][f] = v; save(); }

function renderNav() {
  const nav = document.getElementById('sidebar-nav');
  const y = cur.getFullYear();
  const ck = dk(cur);
  const tk = dk(new Date());
  const mf = ['January','February','March','April','May','June','July','August','September','October','November','December'];
  const dn = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
  let h = `<div class="year-label">${y}</div>`;
  for (let m = 0; m < 12; m++) {
    const isCur = m === cur.getMonth();
    h += `<div class="month-group ${isCur ? '' : 'collapsed'}" id="mg-${m}">
      <div class="month-label" onclick="document.getElementById('mg-${m}').classList.toggle('collapsed')">
        <span class="arr">‚ñº</span>${mf[m]}</div><div class="day-list">`;
    const days = new Date(y, m+1, 0).getDate();
    for (let d = 1; d <= days; d++) {
      const dt = new Date(y, m, d);
      const key = dk(dt);
      const active = key === ck ? ' active' : '';
      const today = key === tk ? ' today' : '';
      const has = data[key] && Object.values(data[key]).some(v => v.p || v.a) ? ' has-plans' : '';
      h += `<div class="day-item${active}${today}${has}" onclick="go('${key}')">${dn[dt.getDay()]} ${d}</div>`;
    }
    h += '</div></div>';
  }
  nav.innerHTML = h;
}

function renderGrid() {
  const key = dk(cur);
  const dd = gd(key);
  const now = new Date();
  const isToday = dk(now) === key;
  const curH = now.getHours();
  const curM = now.getMinutes();
  const dn = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
  const mn = ['January','February','March','April','May','June','July','August','September','October','November','December'];

  document.getElementById('title').textContent = `${dn[cur.getDay()]}, ${cur.getDate()} ${mn[cur.getMonth()]}`;

  let html = '';
  for (let h = 5; h <= 23; h++) {
    for (let m = 0; m <= 30; m += 30) {
      const sk = slotKey(h, m);
      const sr = dd[sk] || { p: '', a: '' };
      const isHourStart = m === 0;
      const isCurrent = isToday && h === curH && ((m === 0 && curM < 30) || (m === 30 && curM >= 30));
      const rowClass = `slot-row${isHourStart ? ' hour-start' : ' half-hour'}${isCurrent ? ' current' : ''}`;
      const timeLabel = `${String(h).padStart(2,'0')}:${m === 0 ? '00' : '30'}`;

      html += `<div class="${rowClass}" id="sr-${h}-${m}">
        <div class="slot-time">${timeLabel}</div>
        <div class="slot-cell plan-cell">
          <textarea class="cell-input" placeholder="‚Äî" rows="1"
            oninput="autoH(this);edit('${key}','${sk}','p',this.value)"
            onblur="edit('${key}','${sk}','p',this.value)">${esc(sr.p)}</textarea>
        </div>
        <div class="slot-cell actual-cell">
          <textarea class="cell-input" placeholder="‚Äî" rows="1"
            oninput="autoH(this);edit('${key}','${sk}','a',this.value)"
            onblur="edit('${key}','${sk}','a',this.value)">${esc(sr.a)}</textarea>
        </div>
      </div>`;
    }
  }
  document.getElementById('grid').innerHTML = html;
  document.querySelectorAll('.cell-input').forEach(autoH);

  if (isToday) setTimeout(() => {
    const el = document.getElementById(`sr-${curH}-${curM < 30 ? 0 : 30}`);
    if (el) el.scrollIntoView({ block: 'center' });
  }, 50);

  updateSummary(key);
}

function autoH(el) { el.style.height = 'auto'; el.style.height = el.scrollHeight + 'px'; }
function esc(s) { return (s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

let st;
function edit(k, sk, f, v) { clearTimeout(st); st = setTimeout(() => { set(k, sk, f, v); updateSummary(k); }, 400); }

function updateSummary(k) {
  const dd = gd(k);
  let planned=0, done=0, missed=0;
  const now = new Date();
  Object.entries(dd).forEach(([sk, v]) => {
    if (v.p && v.p.trim()) {
      if (v.a && v.a.trim()) done++;
      else {
        const [h,m] = sk.split(':').map(Number);
        if (dk(now)===k && (h < now.getHours() || (h === now.getHours() && m <= now.getMinutes()))) missed++;
        else planned++;
      }
    }
  });
  document.getElementById('summary').innerHTML =
    `<div class="stat"><div class="stat-bar planned"></div>${planned} planned</div>
     <div class="stat"><div class="stat-bar done"></div>${done} done</div>
     ${missed ? `<div class="stat"><div class="stat-bar missed"></div>${missed} missed</div>` : ''}`;
}

function goToday() { cur = new Date(); renderNav(); renderGrid(); }
function go(k) { const p = k.split('-'); cur = new Date(+p[0], +p[1]-1, +p[2]); renderNav(); renderGrid(); }
function prevDay() { cur.setDate(cur.getDate()-1); renderNav(); renderGrid(); }
function nextDay() { cur.setDate(cur.getDate()+1); renderNav(); renderGrid(); }

function exportMD() {
  const k = dk(cur);
  const dd = gd(k);
  let md = `# ${k}\n\n| Time | Plan | Actual |\n|------|------|--------|\n`;
  for (let h = 5; h <= 23; h++) {
    for (let m = 0; m <= 30; m += 30) {
      const sk = slotKey(h, m);
      const sr = dd[sk] || {};
      md += `| ${sk} | ${(sr.p||'‚Äî').replace(/\n/g,' ')} | ${(sr.a||'‚Äî').replace(/\n/g,' ')} |\n`;
    }
  }
  navigator.clipboard.writeText(md);
  const t = document.getElementById('toast'); t.textContent='Copied'; t.classList.add('show');
  setTimeout(()=>{ t.classList.remove('show'); t.textContent='Saved'; }, 1500);
}

document.addEventListener('keydown', e => {
  if (e.target.tagName==='TEXTAREA') return;
  if (e.key==='ArrowLeft') prevDay();
  if (e.key==='ArrowRight') nextDay();
  if (e.key==='t') goToday();
});

// Init
load();

const tk = dk(new Date());
if (!data[tk] || Object.keys(data[tk]).length === 0) {
  const s = {
    '07:00': { p: 'üèãÔ∏è Gym', a: '' },
    '07:30': { p: 'üèãÔ∏è Gym', a: '' },
    '08:00': { p: 'üèãÔ∏è Gym', a: '' },
    '08:30': { p: 'Get ready + breakfast', a: '' },
    '09:00': { p: 'üöó Drop Kyle to school', a: '' },
    '09:30': { p: 'üìû Ventaz & Craftit ‚Äî prep + send 10 LinkedIn DMs', a: '' },
    '10:00': { p: 'üìû Ventaz & Craftit ‚Äî send 10 LinkedIn DMs', a: '' },
    '10:30': { p: 'üìû Ventaz & Craftit ‚Äî send 5 cold emails', a: '' },
    '11:00': { p: 'üìû Ventaz & Craftit ‚Äî post LinkedIn content + engage', a: '' },
    '11:30': { p: 'üìû Ventaz & Craftit ‚Äî follow up + update CRM', a: '' },
    '12:00': { p: 'Lunch', a: '' },
    '12:30': { p: 'Backend Chapter Meeting', a: '' },
    '13:00': { p: 'Backend Chapter Meeting (till 1:30)', a: '' },
    '13:30': { p: 'üéÅ Pick up printed photos + gift for Andy', a: '' },
    '14:00': { p: 'üéÅ Errands continued ‚Üí head home', a: '' },
    '14:30': { p: 'Back home ‚Äî Day job', a: '' },
    '15:00': { p: 'PMO Task Tracking meeting (3:00-3:30)', a: '' },
    '15:30': { p: 'Day job', a: '' },
    '16:00': { p: 'Day job', a: '' },
    '16:30': { p: 'Day job', a: '' },
    '17:00': { p: 'Day job', a: '' },
    '17:30': { p: 'Wrap up day job', a: '' },
    '18:00': { p: 'üìñ Rylie study ‚Äî P3 weighted assessments', a: '' },
    '18:30': { p: 'üìñ Rylie study', a: '' },
    '19:00': { p: 'üé® Craftit AI ‚Äî daily standup', a: '' },
    '19:30': { p: 'Dinner + family time', a: '' },
    '20:00': { p: 'üìû Ventaz Sales ‚Äî outreach (10 DMs)', a: '' },
    '20:30': { p: 'üìû Ventaz Sales ‚Äî follow-ups', a: '' },
    '21:00': { p: 'üìû Ventaz Sales ‚Äî demo calls', a: '' },
    '21:30': { p: 'ü§ñ Ventaz AI ‚Äî daily standup', a: '' },
    '22:00': { p: 'üìû Ventaz Sales ‚Äî update CRM + pipeline', a: '' },
    '22:30': { p: 'Review day ‚Äî fill in Actual column', a: '' },
    '23:00': { p: 'Wind down + plan tomorrow', a: '' },
  };
  data[tk] = s;
  save();
}

renderNav();
renderGrid();
</script>
</body>
</html>
